# Active Context

## Current Focus

- **Implementing the new YouTube playlist transcription pipeline as approved:**
  - Fixed transcription model: `openai/whisper-large-v3` via OpenRouter.
  - Sentence splitting and cleanup: SpaCy (required).
  - LLM correction and summarization: User-selectable from all OpenRouter LLMs, with live price calculation based on transcript size.
  - Diarization: Always performed using `pyannote.audio` locally (requires Hugging Face token and setup).
  - Output: Per-video folders with audio, raw transcript, corrected transcript, summary, metadata (CSV/JSON), diarization, and HTML transcript reader.
  - UI: Dropdowns for LLM steps (correction & summarization) populated live from OpenRouter, with real-time cost display.

## Recent Changes

- Plan updated to require diarization (pyannote.audio), live model selection for LLM steps, and fixed models for transcription and sentence splitting.
- All previous planning and options superseded by this new, user-approved workflow.

## Next Steps

- Update all memory bank and planning documents to reflect this plan.
- Refactor code and UI to:
  - Enforce fixed models for transcription and sentence splitting.
  - Add live OpenRouter LLM dropdowns and price calculation for correction and summarization.
  - Integrate pyannote.audio for diarization, with setup checks and error handling.
  - Ensure output structure and logs match the plan.
- **Test the Full Pipeline:**
  - Run the application with a real YouTube playlist to verify that:
    - Live LLM dropdowns populate with all OpenRouter models and display real-time price estimates.
    - Transcription (Whisper), sentence splitting (SpaCy), correction and summarization (selected LLMs), and diarization (pyannote.audio) all execute as expected.
    - All outputs (audio, transcripts, summary, metadata, diarization, HTML reader) are saved per video in the correct structure.
    - Error handling and logs are robust and informative.
- **Refine User Experience:**
  - Adjust UI feedback, error messages, and progress reporting based on test results.
  - Optimize for large playlists and long videos.
- **Update Documentation:**
  - Ensure README and in-app help reflect the new workflow, model selection, cost transparency, and setup requirements (SpaCy, pyannote.audio, Hugging Face token, OpenRouter API key).
- **(Optional) Add Enhancements:**
  - Support for exporting combined metadata.
  - More granular progress bars or status reporting.
  - Additional output formats or downstream integrations as needed.

## Active Decisions & Considerations

- No user options for transcription or sentence splitting models.
- All LLM steps (correction, summarization) are user-selectable from OpenRouter, with live pricing.
- Diarization is always performed using pyannote.audio locally.
- Output is always per-video, with all assets grouped and clearly named.

## Patterns & Preferences

- PEP 8 compliance for all Python code.
- Modular, extensible architecture.
- Robust error handling and logging.
- User experience focused on clarity, transparency of cost, and ease of use.

## Project Insights

- This plan balances quality, flexibility, and cost transparency.
- The memory bank is now fully aligned with the approved implementation path.
